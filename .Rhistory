type == "unknown_110" |
type == "Jumping Effect" |
type == "Jumps" |
type == "avg_heart_rate" |
type == "max_heart_rate" |
type == "avg_temperature" |
type == "max_temperature" |
type == "start_time" |
type == "sub_sport" |
type == "total_anaerobic_training_effect" |
type == "total_training_effect" |
type == "total_calories" |
type == "total_elapsed_time"
) %>%
select(type, value) %>%
pivot_wider(names_from = type) %>%
type_convert(col_types = cols(.default = col_double(),
start_time = col_datetime(),
sub_sport = col_character(),
unknown_110 = col_character()
)
) %>%
rename(name = unknown_110,
jumpingEffect = "Jumping Effect",
jumps = Jumps
)
}
passFit <- function() {
getJumpData(getFitOut())
}
datalist = list()
for (i in 1:length(cardio$activity_id)) {
fitFile <- cardio$activity_id[i]
dat <- passFit()
datalist[[i]] <- dat
}
jumpData <-
bind_rows(datalist) %>%
filter(jumps > 0) %>%
mutate(jpm = jumps / total_elapsed_time * 60)
pltJumpData <-
jumpData %>%
select(-sub_sport, -name) %>%
pivot_longer(-start_time)
ggplot(pltJumpData, aes(start_time, value)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ name, scales = "free_y") +
labs(title = "Summary of jump rope session data",
x = "Date",
y = "Value") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)))) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
# ggplot(jumpData, aes(start_time, jpm, color = Hmisc::cut2(jumps, cuts = c(501)))) +
#   geom_point() +
#   geom_smooth(method = lm, se = FALSE)
# ggplot(jumpData %>% filter(jumps >= 500), aes(jpm, avg_heart_rate, label = jumps)) +
#   geom_point() +
#   geom_text(vjust = 0, nudge_y = 0.3)
knitr::opts_chunk$set(echo = F, message = F, warning = F, fig.align = "center")
# py_install("python-fitparse")
# py_config()
# py_available(initialize = FALSE)
# py_module_available("fitparse")
# conda_list()
# use_condaenv(condaenv = "auto")
library(DBI)
library(RSQLite)
library(tidyverse)
# Setup a working directory to copy files to for processing.
workDir <- "~/HealthData/FitFiles/working/"
# setwd(workDir)
con <- dbConnect(SQLite(), "/Users/amrit/HealthData/DBs/garmin_activities.db")
# dbListTables(con)
acts <- dbReadTable(con, 'activities')
# Path of the SQLite activities database.
path <- "/Users/amrit/HealthData/FitFiles/Activities/"
# Get .fit filenames based on running activity names.
cardio <-
acts %>%
filter(sub_sport == "cardio_training") %>%
arrange(desc(start_time)) %>%
# Allow partial activity date matching.
filter(str_detect(start_time, "2020-")) %>%
select(start_time, activity_id) %>%
mutate(activity_id = paste0(path, activity_id, ".fit"))
save(cardio, file = "~/HealthData/FitFiles/working/cardio.Rdata")
# Copy .fit files to working directory.
walk(paste("cp", cardio$activity_id, workDir), system) # same as lapply w/ no output printed
library(reticulate)
virtualenv_create("jumps")
py_install("fitparse", envname = "jumps")
use_virtualenv("jumps")
library(reticulate)
virtualenv_create("jumps")
py_install("fitparse", envname = "jumps")
use_virtualenv("jumps")
knitr::opts_chunk$set(echo = F, message = F, warning = F, fig.align = "center")
library(reticulate)
virtualenv_create("jumps")
py_install("fitparse", envname = "jumps")
use_virtualenv("jumps")
# py_install("python-fitparse")
# py_config()
# py_available(initialize = FALSE)
# py_module_available("fitparse")
# conda_list()
# use_condaenv(condaenv = "auto")
library(DBI)
library(RSQLite)
library(tidyverse)
# Setup a working directory to copy files to for processing.
workDir <- "~/HealthData/FitFiles/working/"
# setwd(workDir)
con <- dbConnect(SQLite(), "/Users/amrit/HealthData/DBs/garmin_activities.db")
# dbListTables(con)
acts <- dbReadTable(con, 'activities')
# Path of the SQLite activities database.
path <- "/Users/amrit/HealthData/FitFiles/Activities/"
# Get .fit filenames based on running activity names.
cardio <-
acts %>%
filter(sub_sport == "cardio_training") %>%
arrange(desc(start_time)) %>%
# Allow partial activity date matching.
filter(str_detect(start_time, "2020-")) %>%
select(start_time, activity_id) %>%
mutate(activity_id = paste0(path, activity_id, ".fit"))
save(cardio, file = "~/HealthData/FitFiles/working/cardio.Rdata")
# Copy .fit files to working directory.
walk(paste("cp", cardio$activity_id, workDir), system) # same as lapply w/ no output printed
getFitOut <- function() {
library(reticulate)
py_capture_output(py_run_string("import fitparse
# Load the FIT file
fitfile = fitparse.FitFile(r.fitFile)
# Iterate over all messages of type \"record\"
# (other types include \"device_info\", \"file_creator\", \"event\", etc)
for record in fitfile.get_messages(\"session\"):
# Records can contain multiple pieces of data (ex: timestamp, latitude, longitude, etc)
for data in record:
# Print the name and value of the data (and the units if it has any)
if data.units:
print(\"{}, {}, {}\".format(data.name, data.value, data.units))
else:
print(\"{}, {}, NA\".format(data.name, data.value))
"))
}
getJumpData <- function(jumpFit) {
# Run python file created by @mcandocia on GitHub @ https://github.com/mcandocia/examples/tree/master/convert_fit_to_csv
# to convert .fit data to .csv to allow for processing in R.
# source_python("jumps.py", envir = NULL)
jump <- read_csv(jumpFit, col_name = c('type', 'value', 'units'))
jump %>%
filter(
type == "unknown_110" |
type == "Jumping Effect" |
type == "Jumps" |
type == "avg_heart_rate" |
type == "max_heart_rate" |
type == "avg_temperature" |
type == "max_temperature" |
type == "start_time" |
type == "sub_sport" |
type == "total_anaerobic_training_effect" |
type == "total_training_effect" |
type == "total_calories" |
type == "total_elapsed_time"
) %>%
select(type, value) %>%
pivot_wider(names_from = type) %>%
type_convert(col_types = cols(.default = col_double(),
start_time = col_datetime(),
sub_sport = col_character(),
unknown_110 = col_character()
)
) %>%
rename(name = unknown_110,
jumpingEffect = "Jumping Effect",
jumps = Jumps
)
}
pltJumpData <-
jumpData %>%
select(-sub_sport, -name) %>%
pivot_longer(-start_time)
ggplot(pltJumpData, aes(start_time, value)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ name, scales = "free_y") +
labs(title = "Summary of jump rope session data",
x = "Date",
y = "Value") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)))) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
# ggplot(jumpData, aes(start_time, jpm, color = Hmisc::cut2(jumps, cuts = c(501)))) +
#   geom_point() +
#   geom_smooth(method = lm, se = FALSE)
# ggplot(jumpData %>% filter(jumps >= 500), aes(jpm, avg_heart_rate, label = jumps)) +
#   geom_point() +
#   geom_text(vjust = 0, nudge_y = 0.3)
jumpData
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 0.3) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 0.4) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 0.5) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 1.5) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point(aes(colour = jumps)) +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
library(plotly)
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplotly(p)
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
# geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplotly(p)
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = jumps, label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
# geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplotly(p)
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = Hmisc::cut2(jumps, cuts = c(501)), label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
# geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)",
color = "Jumps")
ggplotly(p)
jumpGroup <- Hmisc::cut2(jumpData$jumps, cuts = c(501))
jumpGroup <- Hmisc::cut2(jumpData$jumps, cuts = c(501))
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = jumpGroup, label = jumps)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
# geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)")
ggplotly(p)
View(jumpData)
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = jumpGroup,
label  = jumps,
label2 = jpm,
label3 = max_heart_rate,
label4 = total_training_effect,
label5 = jumpingEffect
)
) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
# geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)")
ggplotly(p)
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = jumpGroup,
label  = jumps,
label2 = jpm,
label3 = max_heart_rate,
label4 = total_training_effect,
label5 = jumpingEffect
)
) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
# geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)")
ggplotly(p) %>%
layout(title = list(text = paste0("Change in cardio fitness over time from jumping rope",
'<br>',
'<sup>',
"Goal is min of 10 min. continuous jumping per session",
'</sup>')))
blogdown:::serve_site()
knitr::opts_chunk$set(echo = F, message = F, warning = F, fig.align = "center")
library(reticulate)
virtualenv_create("jumps")
py_install("fitparse", envname = "jumps")
use_virtualenv("jumps")
# py_install("python-fitparse")
# py_config()
# py_available(initialize = FALSE)
# py_module_available("fitparse")
# conda_list()
# use_condaenv(condaenv = "auto")
library(DBI)
library(RSQLite)
library(tidyverse)
# Setup a working directory to copy files to for processing.
workDir <- "~/HealthData/FitFiles/working/"
# setwd(workDir)
con <- dbConnect(SQLite(), "/Users/amrit/HealthData/DBs/garmin_activities.db")
# dbListTables(con)
acts <- dbReadTable(con, 'activities')
# Path of the SQLite activities database.
path <- "/Users/amrit/HealthData/FitFiles/Activities/"
# Get .fit filenames based on running activity names.
cardio <-
acts %>%
filter(sub_sport == "cardio_training") %>%
arrange(desc(start_time)) %>%
# Allow partial activity date matching.
filter(str_detect(start_time, "2020-")) %>%
select(start_time, activity_id) %>%
mutate(activity_id = paste0(path, activity_id, ".fit"))
save(cardio, file = "~/HealthData/FitFiles/working/cardio.Rdata")
# Copy .fit files to working directory.
walk(paste("cp", cardio$activity_id, workDir), system) # same as lapply w/ no output printed
getFitOut <- function() {
library(reticulate)
py_capture_output(py_run_string("import fitparse
# Load the FIT file
fitfile = fitparse.FitFile(r.fitFile)
# Iterate over all messages of type \"record\"
# (other types include \"device_info\", \"file_creator\", \"event\", etc)
for record in fitfile.get_messages(\"session\"):
# Records can contain multiple pieces of data (ex: timestamp, latitude, longitude, etc)
for data in record:
# Print the name and value of the data (and the units if it has any)
if data.units:
print(\"{}, {}, {}\".format(data.name, data.value, data.units))
else:
print(\"{}, {}, NA\".format(data.name, data.value))
"))
}
getJumpData <- function(jumpFit) {
# Run python file created by @mcandocia on GitHub @ https://github.com/mcandocia/examples/tree/master/convert_fit_to_csv
# to convert .fit data to .csv to allow for processing in R.
# source_python("jumps.py", envir = NULL)
jump <- read_csv(jumpFit, col_name = c('type', 'value', 'units'))
jump %>%
filter(
type == "unknown_110" |
type == "Jumping Effect" |
type == "Jumps" |
type == "avg_heart_rate" |
type == "max_heart_rate" |
type == "avg_temperature" |
type == "max_temperature" |
type == "start_time" |
type == "sub_sport" |
type == "total_anaerobic_training_effect" |
type == "total_training_effect" |
type == "total_calories" |
type == "total_elapsed_time"
) %>%
select(type, value) %>%
pivot_wider(names_from = type) %>%
type_convert(col_types = cols(.default = col_double(),
start_time = col_datetime(),
sub_sport = col_character(),
unknown_110 = col_character()
)
) %>%
rename(name = unknown_110,
jumpingEffect = "Jumping Effect",
jumps = Jumps
)
}
passFit <- function() {
getJumpData(getFitOut())
}
datalist = list()
for (i in 1:length(cardio$activity_id)) {
fitFile <- cardio$activity_id[i]
dat <- passFit()
datalist[[i]] <- dat
}
jumpData <-
bind_rows(datalist) %>%
filter(jumps > 0) %>%
mutate(jpm = jumps / total_elapsed_time * 60)
View(jumpData)
pltJumpData <-
jumpData %>%
select(-sub_sport, -name) %>%
pivot_longer(-start_time)
ggplot(pltJumpData, aes(start_time, value)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ name, scales = "free_y") +
labs(title = "Summary of jump rope session data",
x = "Date",
y = "Value") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
jumpGroup <- Hmisc::cut2(jumpData$jumps, cuts = c(501))
p <-
ggplot(jumpData, aes(start_time, avg_heart_rate, color = jumpGroup,
label  = jumps,
label2 = jpm,
label3 = max_heart_rate,
label4 = total_training_effect,
label5 = jumpingEffect
)
) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
# geom_text(vjust = 0, nudge_y = 1.0) +
labs(title = "Change in cardio fitness over time from jumping rope",
subtitle = "Goal is min of 10 min. continuous jumping per session",
x = "Date",
y = "Average heart rate (bpm)")
plotly::ggplotly(p) %>%
layout(title = list(text = paste0("Change in cardio fitness over time from jumping rope",
'<br>',
'<sup>',
"Goal is min of 10 min. continuous jumping per session",
'</sup>')))
blogdown:::serve_site()
